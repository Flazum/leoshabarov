<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Leo Shabarov</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{--ink:#eaf1ff;--muted:#a8b4d9;--line:#1a1f36;--bg:#070913;--g1:#6ee7ff;--g2:#8b5cf6;--gap:8px}
html,body{height:100%}
body{font-family:'Space Grotesk',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink);overflow-x:hidden}
.wrap{width:min(1200px,92%);margin-inline:auto}
.header{position:sticky;top:0;z-index:20;background:linear-gradient(180deg,rgba(7,9,19,.8),rgba(7,9,19,.5) 70%,transparent);backdrop-filter:blur(10px)}
.nav{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
.brand{display:flex;align-items:center;gap:.7rem;text-decoration:none;color:inherit}
.logo{width:44px;height:44px;border-radius:12px;background:conic-gradient(from var(--rot,0deg),var(--g1),var(--g2),#4dd4ff,#a78bfa,var(--g1));display:grid;place-items:center;box-shadow:0 10px 30px #0009}
.title{font-weight:700}
.links{display:flex;gap:1rem}
.links a{color:var(--ink);text-decoration:none;font-weight:700;opacity:.9}
.iconbtn{width:48px;height:48px;border-radius:12px;display:grid;place-items:center;background:#0a0f26;border:1px solid var(--line);transition:transform .08s,box-shadow .2s}
.iconbtn:hover{transform:translateY(-1px);box-shadow:0 12px 28px #0008}
.hero{position:relative;min-height:86vh;display:grid;place-items:center}
.hgrid{display:grid;grid-template-columns:1.1fr .9fr;gap:46px;align-items:center}
.h1{font-size:clamp(2.8rem,6vw,5rem);line-height:1.03;letter-spacing:-.01em}
.lead{color:var(--muted);margin-top:10px}
.actions{display:flex;gap:12px;margin-top:18px}
.portrait{width:360px;max-width:100%;aspect-ratio:9/16;border:none;border-radius:18px;overflow:hidden;background:transparent}
.portrait img{width:100%;height:100%;object-fit:cover}
.section{padding:44px 0}
.section h2{font-size:clamp(1.5rem,2.6vw,2rem);margin-bottom:14px}
.rail{position:relative;overflow:hidden;border-radius:18px;border:1px solid var(--line);background:linear-gradient(180deg,#0a0f1e,#090b18)}
.track{display:flex;gap:18px;align-items:center;padding:16px;animation:move 26s linear infinite}
@keyframes move{to{transform:translateX(-50%)}}
.rail.paused .track{animation-play-state:paused}
.chip{position:relative;padding:.9rem 1.15rem;border-radius:16px;border:1px solid #22284a;background:#0a0f26;font-weight:900;box-shadow:0 10px 24px #0007;white-space:nowrap;transition:transform .18s,box-shadow .25s,border-color .2s,background .2s,opacity .2s}
.rail.paused .chip{opacity:.5}
.rail.paused .chip.active{opacity:1}
.chip.active{transform:translateZ(0) scale(1.14);background:linear-gradient(180deg,#111733,#0a0f26);border-color:#4a52a6;box-shadow:0 18px 50px rgba(110,231,255,.25),0 0 0 2px rgba(110,231,255,.18) inset}
.chip.active::after{content:"";position:absolute;inset:-4px;border-radius:20px;pointer-events:none;box-shadow:0 0 0 2px rgba(110,231,255,.2),0 0 26px rgba(139,92,246,.35)}
.center{display:grid;place-items:center;margin-top:14px}
.pill{display:inline-flex;align-items:center;gap:.6rem;padding:.9rem 1.3rem;border-radius:999px;border:0;background:linear-gradient(135deg,var(--g1),var(--g2));color:#0a0c18;font-weight:900;box-shadow:0 10px 28px #0009}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
.card{border-radius:16px;border:1px solid var(--line);background:linear-gradient(180deg,rgba(15,20,40,.7),rgba(10,14,28,.7));box-shadow:0 14px 36px #0009;transform-style:preserve-3d;transition:transform .15s}
.card img{width:100%;display:block;border-bottom:1px solid var(--line)}
.card a{display:block;padding:14px 16px;color:#eaf1ff;text-decoration:none}
#tiles{position:fixed;inset:0;z-index:-1;pointer-events:none}
.tgrid{position:absolute;inset:-10vh -10vw;display:grid;gap:var(--gap);grid-template-columns:repeat(var(--cols),minmax(0,1fr));transform:perspective(1200px) rotateX(var(--rx,14deg)) rotateY(var(--ry,-10deg)) scale(1.05) translate3d(0,0,0);transform-origin:50% 30%;will-change:transform}
.tile{width:100%;aspect-ratio:1/1;perspective:800px;will-change:transform}
.face{position:relative;width:100%;height:100%;border-radius:10px;transform-style:preserve-3d;transition:transform .5s cubic-bezier(.2,.8,.2,1),box-shadow .3s}
.front,.back{position:absolute;inset:0;border-radius:10px;backface-visibility:hidden}
.front{background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));border:1px solid #121630}
.back{transform:rotateY(180deg);background:radial-gradient(circle at 50% 50%,rgba(110,231,255,.9),rgba(139,92,246,.9) 60%,rgba(110,231,255,.7) 100%);box-shadow:0 12px 32px rgba(110,231,255,.25)}
.tile.active .face{transform:rotateY(180deg)}
.reveal{opacity:0;transform:translateY(16px);transition:opacity .6s,transform .6s}
.reveal.on{opacity:1;transform:none}
.cursor{position:fixed;left:0;top:0;width:30px;height:30px;border-radius:50%;background:radial-gradient(circle at 30% 30%,rgba(255,255,255,.85),rgba(255,255,255,.2));mix-blend-mode:overlay;pointer-events:none;z-index:99;transform:translate(-50%,-50%)}
.course-info{position:relative;margin-top:16px}
.course-panel{display:none;grid-template-columns:1.2fr .8fr;gap:16px;align-items:center;border:1px solid var(--line);border-radius:16px;background:linear-gradient(180deg,#0b1024,#0a0f1e);box-shadow:0 18px 50px rgba(0,0,0,.45),0 0 0 1px rgba(110,231,255,.08) inset;padding:16px;animation:fadeIn .22s ease}
.course-panel.show{display:grid}
.course-title{font-weight:800;font-size:1.15rem;margin-bottom:6px}
.course-desc{color:#c1cced;font-size:.98rem;line-height:1.45}
.course-bullets{margin-top:8px;color:#a8b4d9;font-size:.95rem}
.course-bullets li{margin-left:18px;margin-top:4px}
.preview{position:relative;width:100%;border:1px solid var(--line);border-radius:12px;overflow:hidden;background:linear-gradient(180deg,#070a12,#050812)}
#courseCanvas{width:100%;height:240px;display:block}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
@media (max-width:980px){.hgrid{grid-template-columns:1fr}.portrait{width:280px}}
.gallery{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px}
.gallery a{display:block;border:1px solid var(--line);border-radius:14px;overflow:hidden;background:#0b1022}
.gallery img{display:block;width:100%;height:auto}
</style>
</head>
<body>
<div id="tiles"></div>
<header class="header">
  <div class="wrap nav">
    <a class="brand" href="#top"><div class="logo"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2l2.8 6.6L22 9.3l-5 4.6L18.6 21 12 17.7 5.4 21 7 13.9 2 9.3l7.2-.7L12 2z" fill="white"/></svg></div><span class="title">Leo Shabarov</span></a>
    <div class="links">
      <a href="#about">About</a>
      <a href="#courses">Courses</a>
      <a href="#desmos">Desmos</a>
      <a href="#contact">Contact</a>
    </div>
  </div>
</header>

<main class="wrap">
  <section class="hero" id="top">
    <div class="hgrid">
      <div>
        <h1 class="h1">I build playful, math-flavored things.</h1>
        <p class="lead">Tiled gradient background on a tilted plane. Tiles flip and glow under your cursor, then relax after 0.5s.</p>
        <div class="actions">
          <a class="iconbtn" href="https://www.youtube.com/@leoshabarov" target="_blank" aria-label="YouTube"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M23 12s0-3.3-.42-4.9c-.24-.9-.95-1.6-1.85-1.85C18.98 4.92 12 4.92 12 4.92s-6.98 0-8.73.33c-.9.25-1.61.96-1.85 1.86C1 8.7 1 12 1 12s0 3.3.42 4.9c.24.9.95 1.6 1.85 1.85 1.75.33 8.73.33 8.73.33s6.98 0 8.73-.33c.9-.25 1.61-.95 1.85-1.85.42-1.6.42-4.9.42-4.9z" fill="#ff0033"/><path d="M9.75 8.75v6.5L15.5 12l-5.75-3.25z" fill="#fff"/></svg></a>
          <a class="iconbtn" href="https://www.instagram.com/leoshabarov/" target="_blank" aria-label="Instagram"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g" x1="0" x2="24" y1="0" y2="24"><stop stop-color="#feda75"/><stop offset=".3" stop-color="#fa7e1e"/><stop offset=".6" stop-color="#d62976"/><stop offset="1" stop-color="#962fbf"/></linearGradient></defs><rect x="4" y="4" width="16" height="16" rx="5" fill="url(#g)"/><circle cx="12" cy="12" r="3.5" fill="#fff"/><circle cx="17.5" cy="6.5" r="1.2" fill="#fff"/></svg></a>
        </div>
      </div>
      <div class="portrait" id="portrait"><img src="images/portrait.png" alt="Portrait of Leo"></div>
    </div>
  </section>

  <section id="about" class="section reveal">
    <h2>About</h2>
    <p class="lead">I like problems that reward patience and clarity. My favorite loop is learn → explain → build. I drift toward visuals that make tricky concepts feel obvious.</p>
  </section>

  <section id="courses" class="section reveal">
    <h2>Courses I’ve finished</h2>
    <div class="rail" id="rail"><div class="track" id="track"></div></div>

    <div class="course-info">
      <div class="course-panel" id="coursePanel">
        <div>
          <div class="course-title" id="courseTitle"></div>
          <div class="course-desc" id="courseDesc"></div>
          <ul class="course-bullets" id="courseBullets"></ul>
        </div>
        <div class="preview"><canvas id="courseCanvas"></canvas></div>
      </div>
    </div>

    <div class="center"><div class="pill">Currently learning: Complex Analysis</div></div>
  </section>

  <section id="desmos" class="section reveal">
    <h2>Desmos Gallery</h2>
    <div class="grid">
      <div class="card">
        <a href="https://www.desmos.com/calculator/be7a168fbe" target="_blank" rel="noopener">
          <img src="images/unit_circle.png" alt="Unit Circle Visualization">
          Unit Circle Visualization
        </a>
      </div>
      <div class="card">
        <a href="https://www.desmos.com/calculator/14a5e1c18a" target="_blank" rel="noopener">
          <img src="images/stinky.png" alt="Animation Preview">
          Animation Preview
        </a>
      </div>
      <div class="card">
        <a href="https://www.desmos.com/calculator/3666017f8b" target="_blank" rel="noopener">
          <img src="images/3d_cube.png" alt="3D Cube">
          3D Cube
        </a>
      </div>
    </div>
  </section>

  <section id="contact" class="section reveal">
    <h2>Contact</h2>
    <div class="grid"><div class="card"><a href="mailto:hello@leoshabarov.com">Email</a></div></div>
  </section>
</main>

<footer class="wrap"><div class="nav" style="padding:0"><a class="brand" href="#top"><div class="logo"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2l2.8 6.6L22 9.3l-5 4.6L18.6 21 12 17.7 5.4 21 7 13.9 2 9.3l7.2-.7L12 2z" fill="white"/></svg></div><span class="title">Leo Shabarov</span></a><div style="color:#7f93c9">© <span id="year"></span></div></div></footer>
<div class="cursor" id="cursor"></div>

<script>
let rr=0;setInterval(()=>{rr=(rr+3)%360;document.documentElement.style.setProperty('--rot',rr+'deg')},60)
const tiles=document.getElementById('tiles');let cols,rows,size
function build(){
  tiles.innerHTML='';
  const w=innerWidth,h=innerHeight;
  const gap=parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--gap'))||8;
  size=Math.max(48,Math.min(90,Math.floor(Math.min(w,h)/18)));
  cols=Math.ceil(w/(size+gap));
  rows=Math.ceil(h/(size+gap));
  const g=document.createElement('div');
  g.className='tgrid';
  g.style.setProperty('--cols',cols);
  tiles.appendChild(g);
  for(let y=0;y<rows;y++){
    for(let x=0;x<cols;x++){
      const t=document.createElement('div');
      t.className='tile';
      const f=document.createElement('div');f.className='face';
      const a=document.createElement('div');a.className='front';
      const b=document.createElement('div');b.className='back';
      const u=x/(cols-1||1),v=y/(rows-1||1);
      const hue=200+40*u-20*v;
      const sat=70+10*Math.sin((x+y)*.3);
      const lum=12+8*u+8*(1-v);
      a.style.background=`linear-gradient(180deg,hsla(${hue},${sat}%,${lum+6}%,.22),hsla(${hue},${sat}%,${lum}%,.12))`;
      a.style.border=`1px solid hsla(${hue},50%,18%,1)`;
      b.style.background=`radial-gradient(60% 60% at 50% 50%,hsla(${hue},90%,72%,.95),hsla(${hue+30},90%,65%,.9))`;
      f.appendChild(a);f.appendChild(b);t.appendChild(f);g.appendChild(t);
    }
  }
}
build();addEventListener('resize',build);

let lastHover=null,timers=new WeakMap();
document.addEventListener('mousemove',e=>{
  const g=tiles.firstElementChild;if(!g)return;
  const rect=g.getBoundingClientRect();
  const gap=parseFloat(getComputedStyle(g).gap)||8;
  const firstTile=g.children[0];if(!firstTile)return;
  const tileW=firstTile.offsetWidth, tileH=firstTile.offsetHeight;
  const gx=Math.floor((e.clientX-rect.left)/(tileW+gap));
  const gy=Math.floor((e.clientY-rect.top)/(tileH+gap));
  const cx=rect.left+rect.width/2, cy=rect.top+rect.height/3;
  const dx=(e.clientX-cx)/rect.width, dy=(e.clientY-cy)/rect.height;
  g.style.setProperty('--ry',(10 - dx*10)+'deg');
  g.style.setProperty('--rx',(14 - dy*12)+'deg');
  if(gx<0||gy<0||gx>=cols||gy>=rows)return;
  const idx=gy*cols+gx, t=g.children[idx];
  if(!t||t===lastHover)return;
  lastHover=t; t.classList.add('active');
  if(timers.has(t))clearTimeout(timers.get(t));
  timers.set(t,setTimeout(()=>{t.classList.remove('active');timers.delete(t)},500));
});

const rail=document.getElementById('rail');
const track=document.getElementById('track');
const courses=['Algebra I','Geometry','Algebra II','Pre-Calc','Calculus I','Calculus II','Calculus III','ODE','Linear Algebra','Discrete Math','Real Analysis'];
function row(){const d=document.createElement('div');d.style.display='flex';d.style.gap='18px';for(const c of courses){const el=document.createElement('div');el.className='chip';el.textContent=c;el.dataset.course=c;d.appendChild(el)}return d}
track.appendChild(row());track.appendChild(row());

const courseInfo={
  'Algebra I':{d:'Foundations for symbolic manipulation and linear reasoning.',b:['Variables & expressions','Linear equations/inequalities','Graphing lines','Systems of equations'],a:'line'},
  'Geometry':{d:'Reason about shape, space, and proof.',b:['Congruence & similarity','Triangles & circles','Area/volume','Intro proofs'],a:'poly'},
  'Algebra II':{d:'Nonlinear models and complex arithmetic.',b:['Quadratics & polynomials','Exponentials/logs','Complex numbers','Polynomial roots'],a:'parab'},
  'Pre-Calc':{d:'Bridge to calculus via trig & advanced functions.',b:['Trigonometric graphs','Identities','Polar & parametric','Limits preview'],a:'trig'},
  'Calculus I':{d:'Change via derivatives; accumulation via integrals.',b:['Limits & continuity','Derivatives & rules','Optimization','Riemann sums'],a:'riemann'},
  'Calculus II':{d:'Integration power-ups and infinite processes.',b:['Substitution, parts, partial fractions','Improper integrals','Sequences & series','Taylor approximations'],a:'series'},
  'Calculus III':{d:'Multivariable calculus and 3D intuition.',b:['Partial derivatives & gradient','Level sets & surfaces','Double/triple integrals','Vector fields'],a:'field'},
  'ODE':{d:'Dynamics modeled by differential equations.',b:['Direction fields','Separable & linear ODEs','Phase lines','Applications'],a:'slopefield'},
  'Linear Algebra':{d:'Structure of vectors and transformations.',b:['Matrix transforms','Row spaces & rank','Eigenvalues/vectors','Projections'],a:'matrix'},
  'Discrete Math':{d:'Finite structures, counting, and logic.',b:['Graphs & trees','Induction & recursion','Pigeonhole & inclusion–exclusion','Basic number theory'],a:'graph'},
  'Real Analysis':{d:'Rigor behind calculus.',b:['Epsilon–delta limits','Sequences & series','Continuity & compactness','Differentiation/Integration basics'],a:'limit'}
};

const panel=document.getElementById('coursePanel');
const titleEl=document.getElementById('courseTitle');
const descEl=document.getElementById('courseDesc');
const bulletsEl=document.getElementById('courseBullets');
const canvas=document.getElementById('courseCanvas');
const ctx=canvas.getContext('2d');
const preview=document.querySelector('.preview');
let animRAF=null, panelHover=false, currentAnim=null;

function resizeCanvas(){
  const dpr=Math.min(devicePixelRatio||1,2);
  const cssW=preview.clientWidth;
  if(!cssW) return;
  const cssH=240;
  canvas.width=Math.floor(cssW*dpr);
  canvas.height=Math.floor(cssH*dpr);
  ctx.setTransform(dpr,0,0,dpr,0,0);
}

function axesGrid(){
  const W=canvas.width/(devicePixelRatio||1),H=canvas.height/(devicePixelRatio||1);
  ctx.save();
  ctx.fillStyle='rgba(255,255,255,0.04)';
  for(let x=0;x<=W;x+=20){ctx.fillRect(x,0,1,H)}
  for(let y=0;y<=H;y+=20){ctx.fillRect(0,y,W,1)}
  ctx.restore();
}

function startAnim(type){
  stopAnim();
  currentAnim=type;
  let t=0;
  function draw(){
    t++;
    const W=preview.clientWidth||600, H=240;
    ctx.clearRect(0,0,W,H);
    axesGrid();
    ctx.save();
    ctx.translate(W/2,H/2);
    ctx.lineWidth=2.5;
    ctx.strokeStyle='rgba(142,197,255,.95)';
    if(type==='line'){
      const m=0.8+0.5*Math.sin(t*0.05);
      ctx.beginPath();
      for(let x=-W/2;x<W/2;x+=6){const y=m*(x/3); x===-W/2?ctx.moveTo(x,y):ctx.lineTo(x,y)}
      ctx.stroke();
    } else if(type==='poly'){
      for(let k=0;k<4;k++){
        const R=H/6+k*14; const n=3+((t>>4)+k)%5;
        ctx.beginPath();
        for(let i=0;i<=n;i++){const a=(i/n)*Math.PI*2+t*0.01; const X=Math.cos(a)*R, Y=Math.sin(a)*R; i?ctx.lineTo(X,Y):ctx.moveTo(X,Y)}
        ctx.stroke();
      }
    } else if(type==='parab'){
      ctx.beginPath();
      for(let x=-W/3;x<W/3;x+=6){const y=(x*x)/(H/6)-H/6+18*Math.sin(t*0.05); x===-W/3?ctx.moveTo(x,y):ctx.lineTo(x,y)}
      ctx.stroke();
      ctx.beginPath(); ctx.arc(0,0,38+6*Math.sin(t*0.07),0,6.283); ctx.stroke();
    } else if(type==='trig'){
      ctx.beginPath();
      for(let x=-W/2;x<W/2;x+=4){const y=H/10*Math.sin(x/40+t*0.09); x===-W/2?ctx.moveTo(x,y):ctx.lineTo(x,y)}
      ctx.stroke();
      ctx.strokeStyle='rgba(170,160,255,.9)';
      ctx.beginPath();
      for(let a=0;a<Math.PI*2;a+=0.03){const X=80*Math.sin(2*a+t*0.02),Y=50*Math.sin(3*a+t*0.03); a===0?ctx.moveTo(X,Y):ctx.lineTo(X,Y)}
      ctx.stroke();
    } else if(type==='riemann'){
      const f=x=>0.6*Math.sin(x/40)+0.4*Math.cos(x/25);
      ctx.beginPath();
      for(let x=-W/2;x<W/2;x+=3){const y=80*f(x)+10*Math.sin(t*0.05); x===-W/2?ctx.moveTo(x,y):ctx.lineTo(x,y)}
      ctx.stroke();
      const a=-180,b=180,N=12; const drift=((t%60)/60)*((b-a)/N);
      for(let i=0;i<N;i++){
        const x0=a+i*(b-a)/N+drift, x1=a+(i+1)*(b-a)/N+drift, xm=(x0+x1)/2;
        const y=80*f(xm)+10*Math.sin(t*0.05);
        ctx.fillStyle='rgba(110,231,255,.18)'; ctx.strokeStyle='rgba(110,231,255,.5)';
        ctx.beginPath(); ctx.rect(x0,y,x1-x0,-y); ctx.fill(); ctx.stroke();
      }
    } else if(type==='series'){
      const K=6;
      for(let k=1;k<=K;k++){
        ctx.strokeStyle=`rgba(142,197,255,${.25+.12*k})`;
        ctx.beginPath();
        for(let x=-W/2;x<W/2;x+=3){const y=50*Math.sin(k*(x/42)+t*0.02)/k; x===-W/2?ctx.moveTo(x,y):ctx.lineTo(x,y)}
        ctx.stroke();
      }
    } else if(type==='field'){
      ctx.lineWidth=2; ctx.strokeStyle='rgba(142,197,255,.9)';
      for(let y=-H/4;y<=H/4;y+=36){
        for(let x=-W/4;x<=W/4;x+=36){
          const a=Math.atan2(y,x)+t*0.02; const len=16;
          ctx.beginPath(); ctx.moveTo(x,y); ctx.lineTo(x+len*Math.cos(a),y+len*Math.sin(a)); ctx.stroke();
        }
      }
    } else if(type==='slopefield'){
      ctx.lineWidth=2; ctx.strokeStyle='rgba(142,197,255,.9)';
      for(let y=-H/4;y<=H/4;y+=30){
        for(let x=-W/4;x<=W/4;x+=30){
          const m=(x-y)/(H/8)+0.6*Math.sin(t*0.03); const ang=Math.atan(m); const len=16;
          ctx.beginPath(); ctx.moveTo(x-len*Math.cos(ang),y-len*Math.sin(ang)); ctx.lineTo(x+len*Math.cos(ang),y+len*Math.sin(ang)); ctx.stroke();
        }
      }
    } else if(type==='matrix'){
      const s=40;
      for(let y=-H/4;y<=H/4;y+=s){
        for(let x=-W/4;x<=W/4;x+=s){
          const ax=1+0.3*Math.sin(t*0.03), bx=0.4*Math.cos(t*0.02);
          const ay=0.2*Math.sin(t*0.02), by=1+0.25*Math.cos(t*0.03);
          const nx=ax*x+bx*y, ny=ay*x+by*y;
          ctx.fillStyle='rgba(142,197,255,.95)';
          ctx.beginPath(); ctx.arc(nx*0.25,ny*0.25,2.5,0,6.283); ctx.fill();
        }
      }
    } else if(type==='graph'){
      ctx.lineWidth=1.8; const N=10; const P=[];
      for(let i=0;i<N;i++){const a=i/N*2*Math.PI+t*0.01; P.push([Math.cos(a)*H/5,Math.sin(a)*H/5])}
      ctx.strokeStyle='rgba(142,197,255,.75)';
      for(let i=0;i<N;i++){for(let j=i+1;j<N;j++){ctx.beginPath();ctx.moveTo(P[i][0],P[i][1]);ctx.lineTo(P[j][0],P[j][1]);ctx.stroke()}}
      ctx.fillStyle='rgba(170,200,255,1)';
      for(const [x,y] of P){ctx.beginPath();ctx.arc(x,y,3.5,0,6.283);ctx.fill()}
    } else if(type==='limit'){
      const L=0, eps=30*(0.4+0.3*Math.abs(Math.sin(t*0.02)));
      const Wc=preview.clientWidth||600;
      ctx.fillStyle='rgba(110,231,255,.12)'; ctx.fillRect(-Wc/2,L-eps,Wc,2*eps);
      ctx.strokeStyle='rgba(142,197,255,.95)'; ctx.beginPath(); ctx.moveTo(-Wc/2,L); ctx.lineTo(Wc/2,L); ctx.stroke();
      ctx.fillStyle='rgba(170,200,255,1)';
      for(let n=1;n<=26;n++){const x=-Wc/2+n*(Wc/26); const y=L+(H/3)/n*Math.sin(t*0.03+n*0.4); ctx.beginPath(); ctx.arc(x,y,3,0,6.283); ctx.fill()}
    }
    ctx.restore();
    animRAF=requestAnimationFrame(draw);
  }
  draw();
}

function stopAnim(){if(animRAF){cancelAnimationFrame(animRAF);animRAF=null}}

function showPanel(name){
  const info=courseInfo[name];
  titleEl.textContent=name;
  descEl.textContent=info.d;
  bulletsEl.innerHTML=info.b.map(s=>`<li>${s}</li>`).join('');
  panel.classList.add('show');
  rail.classList.add('paused');
  document.querySelectorAll('.chip').forEach(x=>x.classList.toggle('active',x.dataset.course===name));
  requestAnimationFrame(()=>{resizeCanvas(); startAnim(info.a)});
}

function hidePanel(){
  panel.classList.remove('show');
  rail.classList.remove('paused');
  document.querySelectorAll('.chip').forEach(x=>x.classList.remove('active'));
  stopAnim();
}

let hoverTarget=null;
document.querySelectorAll('.chip').forEach(ch=>{
  ch.addEventListener('mouseenter',()=>{hoverTarget=ch;showPanel(ch.dataset.course)});
  ch.addEventListener('mouseleave',()=>{setTimeout(()=>{if(!panelHover&&hoverTarget===ch)hidePanel()},80)});
});
panel.addEventListener('mouseenter',()=>{panelHover=true;rail.classList.add('paused')});
panel.addEventListener('mouseleave',()=>{panelHover=false;hidePanel()});

const cursor=document.getElementById('cursor');let cx=0,cy=0,tx=0,ty=0;function loop(){cx+=(tx-cx)*0.18;cy+=(ty-cy)*0.18;cursor.style.left=cx+'px';cursor.style.top=cy+'px';requestAnimationFrame(loop)};loop();addEventListener('mousemove',e=>{tx=e.clientX;ty=e.clientY})
document.getElementById('year').textContent=new Date().getFullYear();

const obs=new IntersectionObserver(es=>{for(const e of es){if(e.isIntersecting)e.target.classList.add('on')}},{threshold:.15});for(const el of document.querySelectorAll('.reveal')) obs.observe(el)
</script>
</body>
</html>
