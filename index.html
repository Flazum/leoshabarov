// Updated JavaScript
// - Removed scroll parallax
// - Inverted Y-axis rotation direction
// - Fixed tile index calculation for accurate hover detection

let lastHover = null, timers = new WeakMap();
const cols = 20;
const rows = 15;
const tiles = document.querySelector('.tgrid');

document.addEventListener('mousemove', e => {
  const g = tiles.firstElementChild;
  if (!g) return;
  const rect = g.getBoundingClientRect();
  const cw = rect.width / cols;
  const ch = rect.height / rows;
  const gx = Math.floor((e.clientX - rect.left) / cw);
  const gy = Math.floor((e.clientY - rect.top) / ch);

  const cx = rect.left + rect.width / 2;
  const cy = rect.top + rect.height / 3;
  const dx = (e.clientX - cx) / rect.width;
  const dy = (e.clientY - cy) / rect.height;

  g.style.setProperty('--ry', (-10 + dx * -10) + 'deg'); // Invert Y tilt direction
  g.style.setProperty('--rx', (14 - dy * 12) + 'deg');

  if (gx < 0 || gy < 0 || gx >= cols || gy >= rows) return;
  const idx = gy * cols + gx;
  const t = g.children[idx];
  if (!t || t === lastHover) return;
  lastHover = t;
  activate(t);
});
