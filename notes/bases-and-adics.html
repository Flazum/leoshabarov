<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bases & Adics — Leo Shabarov</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{--ink:#eaf1ff;--muted:#a8b4d9;--line:#1a1f36;--bg:#070913;--g1:#6ee7ff;--g2:#8b5cf6}
html,body{height:100%}
body{font-family:'Space Grotesk',system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#070913;color:var(--ink)}
a{color:inherit}
.header{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,rgba(7,9,19,.9),rgba(7,9,19,.65) 70%,transparent);backdrop-filter:blur(10px);border-bottom:1px solid #121630}
.nav{max-width:980px;margin:0 auto;padding:14px 18px;display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;gap:.7rem;align-items:center;text-decoration:none}
.logo{width:40px;height:40px;border-radius:12px;background:conic-gradient(from var(--rot,0deg),var(--g1),var(--g2),#4dd4ff,#a78bfa,var(--g1));display:grid;place-items:center;box-shadow:0 10px 30px #0009}
.logo svg{filter:drop-shadow(0 2px 6px rgba(0,0,0,.45))}
.toplinks{display:flex;gap:1rem}
.toplinks a{opacity:.9;text-decoration:none}
.wrap{max-width:880px;margin:0 auto;padding:32px 18px 64px}
.h1{font-size:clamp(2.2rem,5.4vw,3.6rem);line-height:1.03;letter-spacing:-.01em;margin-top:8px}
.subtitle{color:var(--muted);margin-top:8px}
.prose{font-size:clamp(1.02rem,2.2vw,1.15rem);line-height:1.75;margin-top:22px;color:#e9eeff}
.prose p+p{margin-top:1rem}
.prose h2{font-size:clamp(1.4rem,3vw,1.8rem);margin:36px 0 8px}
.prose h3{font-size:clamp(1.18rem,2.6vw,1.3rem);margin:26px 0 6px;color:#cbd7ff}
.prose .callout{margin:16px 0;padding:14px 16px;border:1px solid #1a2040;border-radius:14px;background:linear-gradient(180deg,#0b0f24,#0a0d1e)}
.kbd{font-weight:700;background:#0e1227;border:1px solid #1a2040;padding:.1rem .4rem;border-radius:6px}
.center{display:grid;place-items:center}
.panel{margin:18px 0;border:1px solid #1a2040;border-radius:16px;background:linear-gradient(180deg,#0a0f26,#090c1e);box-shadow:0 14px 36px #0009}
.panel .row{display:flex;flex-wrap:wrap;gap:10px;padding:14px}
.input{flex:1 1 240px;display:flex;align-items:center;border:1px solid #232a55;background:#0d1330;border-radius:12px;padding:10px 12px}
.input input,.input select{flex:1;font:inherit;background:transparent;color:var(--ink);border:0;outline:0}
.badge{font-size:.85rem;padding:.25rem .55rem;border-radius:999px;background:linear-gradient(135deg,var(--g1),var(--g2));color:#0a0c18;font-weight:800}
.math{padding:16px;border-top:1px dashed #1b2246}
.grid2{display:grid;grid-template-columns:1fr;gap:16px;padding:14px}
@media (min-width:800px){.grid2{grid-template-columns:1.1fr .9fr}}
.canvasbox{border:1px solid #1a2040;border-radius:14px;overflow:hidden;background:#090e22}
.canvasbox canvas{display:block;width:100%;height:260px}
.inline{display:inline-block;padding:.15rem .5rem;border-radius:999px;background:#0d1330;border:1px solid #232a55;font-weight:700}
.hr{height:1px;background:linear-gradient(90deg,transparent,#1a2145,transparent);margin:32px 0}
.fade{opacity:0;transform:translateY(10px);transition:opacity .6s,transform .6s}
.fade.on{opacity:1;transform:none}
.footer{max-width:980px;margin:38px auto 32px;padding:0 18px;color:#91a1d6;display:flex;justify-content:space-between;align-items:center}
</style>
</head>
<body>
<header class="header">
  <div class="nav">
    <a href="/" class="brand"><div class="logo"><svg width="18" height="18" viewBox="0 0 24 24"><path fill="#fff" d="M12 2l2.8 6.6L22 9.3l-5 4.6L18.6 21 12 17.7 5.4 21 7 13.9 2 9.3l7.2-.7z"/></svg></div><strong>Leo Shabarov</strong></a>
    <div class="toplinks"><a href="/">Home</a><a href="/#notes">Notebook</a></div>
  </div>
</header>

<main class="wrap">
  <section class="fade on">
    <div class="badge">Notebook</div>
    <h1 class="h1">Bases & Adics</h1>
    <p class="subtitle">How changing place-value rewires arithmetic—and how p-adic numbers flip the idea of “closeness.”</p>
  </section>

  <section class="prose fade">
    <p>When we write \(2+2=4\), we’re quietly assuming a language: <em>base 10</em>. Change the language, and the symbol that looks like “4” may become “10” (base 4), or “100” (base 2). The quantity is the same; the <em>digits</em> and <em>place-values</em> change.</p>
    <h2>Place-value, slowly</h2>
    <p>In base \(b\), a string of digits \(d_k d_{k-1}\dots d_1 d_0\) means \(\sum_{i=0}^{k} d_i\, b^i\), with each \(0\le d_i<b\). That’s all. Base 10 just happens to use \(b=10\) and digits \(0\)–\(9\).</p>
    <div class="panel">
      <div class="row">
        <div class="input"><span style="opacity:.7;margin-right:8px">Number</span><input id="numInput" value="1234" spellcheck="false"></div>
        <div class="input"><span style="opacity:.7;margin-right:8px">Base</span><input id="baseInput" type="number" min="2" max="36" value="10"></div>
        <div class="input"><span style="opacity:.7;margin-right:8px">Show in</span><input id="toBase" type="number" min="2" max="36" value="2"></div>
      </div>
      <div class="math"><div id="expansion" class="fade on"></div></div>
    </div>
    <p>Try changing the bases; the expansion updates as you type. For example, \(1234_{10}\) becomes \(10011010010_2\), and the sum of powers of 2 still equals the same quantity.</p>
    <h2>Division-by-base intuition</h2>
    <p>To convert an integer \(N\) into base \(b\), repeatedly divide by \(b\) and record remainders. Those remainders are the digits from right to left. It’s the same algorithm your calculator uses, just exposed.</p>
    <div class="panel">
      <div class="grid2">
        <div class="canvasbox"><canvas id="longDiv"></canvas></div>
        <div class="prose" style="margin:0">
          <p><span class="inline">Live demo</span> Division peels off the lowest digit each step. The remainder at each step becomes a place in the base-\(b\) expansion.</p>
          <p>For \(1234\) in base \(2\), the remainder pattern is \(0,1,0,0,1,0,1,1,0,0,1\) (right to left), giving \(10011010010_2\).</p>
        </div>
      </div>
    </div>
    <div class="hr"></div>
    <h2>Why bother with different bases?</h2>
    <p>Computers speak binary. Hex packs binary digits into readable groups. Base choices simplify patterns: divisibility tests, repeating fractions, checksums, encodings. Changing the place-value often makes a structure obvious.</p>
    <h2>From digits to distance: p-adics</h2>
    <p>Now flip the idea of “nearby.” In usual real numbers, \(0.001\) is close to \(0\) because the <em>left</em> side matches far out. In <em>p-adic</em> numbers, two integers are close if their <em>right</em> ends match in many digits in base \(p\). Tail agreement means proximity.</p>
    <div class="panel">
      <div class="row">
        <div class="input"><span style="opacity:.7;margin-right:8px">p</span><input id="pBase" type="number" min="2" max="19" value="10"></div>
        <div class="input"><span style="opacity:.7;margin-right:8px">A</span><input id="padicA" value="99999"></div>
        <div class="input"><span style="opacity:.7;margin-right:8px">B</span><input id="padicB" value="-1"></div>
      </div>
      <div style="padding:10px 16px;display:grid;gap:10px">
        <div id="tailText" style="opacity:.9"></div>
        <div style="height:10px;border-radius:999px;background:#131a3a;overflow:hidden;border:1px solid #1f2650">
          <div id="tailBar" style="height:100%;width:0;background:linear-gradient(90deg,var(--g1),var(--g2));transition:width .35s"></div>
        </div>
      </div>
    </div>
    <p>This makes identities like \(\ldots 9999_{10} = -1\) natural: add \(1\) and the carry ripples forever to the left, leaving all zeros—i.e., \(0\). In the 10-adics, that tail behavior means \(\ldots 9999\) is exactly one step away from \(0\), so it represents \(-1\).</p>
    <h3>Carry-forever, animated</h3>
    <div class="canvasbox"><canvas id="carry"></canvas></div>
    <div class="hr"></div>
    <h2>Convergence, reversed</h2>
    <p>In reals, \(\sum 10^k\) diverges. In 10-adics, the same series converges because the partial sums end with more and more zeros—tails match better and better. p-adics solve equations that have no real solutions by changing what “getting close” means.</p>
    <h2>Takeaways</h2>
    <p>Base \(b\) controls how numbers are written. Prime bases \(p\) control how integers cluster. Once you see place-value as a design choice, a lot of “weird” phenomena turn into simple, mechanical rules.</p>
  </section>
</main>

<footer class="footer">
  <div>© <span id="year"></span> Leo Shabarov</div>
  <div><a href="/">Back to home</a></div>
</footer>

<script>
let rr=0;setInterval(()=>{rr=(rr+3)%360;document.documentElement.style.setProperty('--rot',rr+'deg')},60)

const numInput=document.getElementById('numInput')
const baseInput=document.getElementById('baseInput')
const toBase=document.getElementById('toBase')
const expansion=document.getElementById('expansion')
const longDiv=document.getElementById('longDiv')
const carry=document.getElementById('carry')
const pBase=document.getElementById('pBase')
const padicA=document.getElementById('padicA')
const padicB=document.getElementById('padicB')
const tailText=document.getElementById('tailText')
const tailBar=document.getElementById('tailBar')

function parseInBase(str,b){
  const s=str.trim()
  if(!s) return 0n
  const neg=s[0]==='-'?1:0
  const digs=s.slice(neg?1:0).toLowerCase()
  const map='0123456789abcdefghijklmnopqrstuvwxyz'
  let val=0n
  for(const ch of digs){
    const v=BigInt(map.indexOf(ch))
    if(v<0n||v>=BigInt(b)) return NaN
    val=val*BigInt(b)+v
  }
  return neg?-val:val
}
function toBaseStr(n,b){
  const map='0123456789abcdefghijklmnopqrstuvwxyz'
  let x=n
  const neg=x<0n
  if(neg) x=-x
  if(x===0n) return '0'
  let out=''
  const B=BigInt(b)
  while(x>0n){const r=Number(x%B);out=map[r]+out;x/=B}
  return neg?'-'+out:out
}
function expansionTex(nStr,fromB,toB){
  const N=parseInBase(nStr,fromB)
  if(Number.isNaN(Number(N))) return 'Invalid digits for base'
  const digits=toBaseStr(N,fromB)
  let terms=[]
  for(let i=0;i<digits.length;i++){
    const d=digits[digits.length-1-i]
    terms.push(`${parseInt(d,36)}\\,\\cdot\\,${fromB}^{${i}}`)
  }
  const left=`${nStr}_{${fromB}}`
  const right=terms.reverse().join(' \\; + \\; ')
  const conv=`${toBaseStr(N,toB)}_{${toB}}`
  return `\$begin:math:display$ ${left}\\\\;=\\\\;${right}\\\\;=\\\\;${conv} \\$end:math:display$`
}
function updateAll(){
  const b1=Math.max(2,Math.min(36,parseInt(baseInput.value||10)))
  baseInput.value=b1
  const b2=Math.max(2,Math.min(36,parseInt(toBase.value||10)))
  toBase.value=b2
  expansion.innerHTML=expansionTex(numInput.value,b1,b2)
  if(window.MathJax&&MathJax.typesetPromise) MathJax.typesetPromise([expansion])

  drawLongDiv(parseInBase(numInput.value,b1),b2)
}
numInput.addEventListener('input',updateAll)
baseInput.addEventListener('input',updateAll)
toBase.addEventListener('input',updateAll)

function drawLongDiv(N,b){
  const ctx=longDiv.getContext('2d')
  const dpr=Math.min(devicePixelRatio||1,2)
  const W=longDiv.clientWidth||720,H=260
  longDiv.width=W*dpr;longDiv.height=H*dpr;ctx.setTransform(dpr,0,0,dpr,0,0)
  ctx.clearRect(0,0,W,H)
  ctx.fillStyle='#eaf1ff';ctx.font='14px Space Grotesk'
  ctx.strokeStyle='rgba(255,255,255,.15)'
  ctx.strokeRect(10,10,W-20,H-20)
  if(typeof N!=='bigint'){ctx.fillText('Invalid input',24,40);return}
  const B=BigInt(b)
  let x=N
  let rows=[]
  let steps=0
  while(x!==0n && steps<28){
    const q=x/B,r=x%B
    rows.push({x:String(x),q:String(q),r:Number(r)})
    x=q;steps++
  }
  if(rows.length===0) rows.push({x:'0',q:'0',r:0})
  const pad=28
  const colX=28, colQ=W/2+10, colR=W-80
  ctx.fillStyle='#a8b4d9'
  ctx.fillText(`divide by base ${b}`,colQ,40)
  ctx.fillText('value',colX,40)
  ctx.fillText('quotient',colQ,60)
  ctx.fillText('remainder → digit',colR-40,40)
  ctx.fillStyle='#eaf1ff'
  let y=80
  for(const row of rows){
    ctx.fillText(row.x,colX,y)
    ctx.fillText(row.q,colQ,y)
    ctx.fillText(String(row.r),colR,y)
    y+=18
  }
  const digs=rows.map(r=>r.r)
  ctx.fillStyle='#91d4ff'
  ctx.fillText('digits (right→left): '+digs.join(', '),colX,H-28)
}

function animCarry(){
  const ctx=carry.getContext('2d')
  const dpr=Math.min(devicePixelRatio||1,2)
  const W=carry.clientWidth||720,H=260
  carry.width=W*dpr;carry.height=H*dpr;ctx.setTransform(dpr,0,0,dpr,0,0)
  let t=0
  function draw(){
    t++
    ctx.clearRect(0,0,W,H)
    ctx.fillStyle='rgba(255,255,255,.08)'
    ctx.fillRect(0,0,W,H)
    const n=18
    const cx=W/2, cy=H/2
    const start=Math.floor((t%240)/240*n)
    ctx.textAlign='center'
    ctx.textBaseline='middle'
    ctx.font='28px Space Grotesk'
    for(let i=0;i<n;i++){
      const x=cx+(i-n/2)*28
      const phase=i<=start
      ctx.fillStyle=phase?'#a8ffde':'#eaf1ff'
      ctx.fillText(phase?'0':'9',x,cy)
    }
    ctx.font='20px Space Grotesk'
    ctx.fillStyle='#ffd6a8'
    ctx.fillText('+ 1',cx-(n/2)*28-36,cy)
    requestAnimationFrame(draw)
  }
  draw()
}

function padicUpdate(){
  const p=parseInt(pBase.value||10)
  const A=BigInt(isNaN(Number(padicA.value))?0:padicA.value)
  const B=BigInt(isNaN(Number(padicB.value))?0:padicB.value)
  const aStr=toBaseStr(A,p)
  const bStr=toBaseStr(B,p)
  let k=0
  while(k<Math.min(aStr.length,bStr.length)){
    const ca=aStr[aStr.length-1-k]||'0'
    const cb=bStr[bStr.length-1-k]||'0'
    if(ca!==cb) break
    k++
  }
  const frac=Math.min(1,k/12)
  tailBar.style.width=`${frac*100}%`
  tailText.innerHTML=`Tail agreement in base ${p}: <strong>${k}</strong> matching digit${k===1?'':'s'} from the right.`
}
[pBase,padicA,padicB].forEach(el=>el.addEventListener('input',padicUpdate))

function resizeCanvases(){
  [longDiv,carry].forEach(c=>{
    const ctx=c.getContext('2d');ctx.setTransform(1,0,0,1,0,0)
  })
  updateAll()
}
window.addEventListener('resize',resizeCanvases)

const io=new IntersectionObserver(es=>{for(const e of es){if(e.isIntersecting)e.target.classList.add('on')}},{threshold:.15})
document.querySelectorAll('.fade').forEach(el=>io.observe(el))

document.getElementById('year').textContent=new Date().getFullYear()

updateAll()
padicUpdate()
animCarry()
</script>

<script>
window.MathJax={tex:{inlineMath:[['\\(','\\)']],displayMath:[['\\[','\\]']]},svg:{fontCache:'global'}}
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js" defer></script>
</body>
</html>
